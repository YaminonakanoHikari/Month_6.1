redis:
  image: redis:7
  container_name: redis
  ports:
    - "6379:6379"
  healthcheck:
    test: ["CMD", "redis-cli", "ping"]
    interval: 2s
    retries: 5

backend:
  build: .
  container_name: django_backend
  command: sh -c "python manage.py migrate && python manage.py runserver 0.0.0.0:8000"
  env_file:
    - .env
  volumes:
    - .:/app
  ports:
    - "8000:8000"
  depends_on:
    redis:
      condition: service_healthy
